{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": ["config:recommended"],
  "labels": ["dependencies"],
  "ignorePresets": [":ignoreModulesAndTests"],
  "customManagers": [
    {
      "customType": "regex",
      "description": "Helm values: registry.k8s.io sidecar images",
      "fileMatch": ["charts/.+/values\\.yaml$"],
      "matchStrings": [
        "repository:\\s*(?<registryUrl>registry\\.k8s\\.io)/(?<depName>[^\\s]+)\\s+tag:\\s*(?<currentValue>[^\\s]+)"
      ],
      "datasourceTemplate": "docker"
    }
  ],
  "packageRules": [
    {
      "description": "Go modules",
      "matchManagers": ["gomod"],
      "addLabels": ["go"],
      "commitMessagePrefix": "chore(deps):"
    },
    {
      "description": "Block k8s.io major version bumps",
      "matchManagers": ["gomod"],
      "matchPackagePrefixes": ["k8s.io/"],
      "matchUpdateTypes": ["major"],
      "enabled": false
    },
    {
      "description": "GitHub Actions",
      "matchManagers": ["github-actions"],
      "addLabels": ["github-actions"],
      "commitMessagePrefix": "chore(ci):"
    },
    {
      "description": "Docker images â€” only stable releases",
      "matchManagers": ["dockerfile"],
      "addLabels": ["docker"],
      "commitMessagePrefix": "chore(docker):",
      "allowedVersions": "!/^.*(?:alpha|beta|rc).*$/"
    },
    {
      "description": "npm (dashboard)",
      "matchManagers": ["npm"],
      "addLabels": ["npm"],
      "commitMessagePrefix": "chore(deps):"
    },
    {
      "description": "Skip pre-release versions globally",
      "matchManagers": ["gomod", "npm"],
      "ignoreUnstable": true
    }
  ],
  "schedule": ["every weekday"]
}
