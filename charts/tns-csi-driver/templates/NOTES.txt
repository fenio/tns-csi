Thank you for installing {{ .Chart.Name }}!

Your release is named {{ .Release.Name }}.

To verify the installation:

1. Check the controller pod status:
   kubectl get pods -n {{ .Release.Namespace }} -l app.kubernetes.io/component=controller

2. Check the node pods status:
   kubectl get pods -n {{ .Release.Namespace }} -l app.kubernetes.io/component=node

3. Verify the CSI driver registration:
   kubectl get csidrivers {{ include "tns-csi-driver.driverName" . }}

4. Check available storage classes:
   kubectl get storageclass

Storage Classes Created:
{{- range .Values.storageClasses }}
{{- if .enabled }}
  - {{ .name }} ({{ .protocol }})
{{- end }}
{{- end }}

To create a test PersistentVolumeClaim:
{{- $firstSC := "" }}
{{- range .Values.storageClasses }}
{{- if and .enabled (eq $firstSC "") }}
{{- $firstSC = .name }}
{{- end }}
{{- end }}

cat <<EOF | kubectl apply -f -
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: test-pvc
spec:
  accessModes:
    - ReadWriteMany
  resources:
    requests:
      storage: 1Gi
   storageClassName: {{ if $firstSC }}{{ $firstSC }}{{ else }}tns-csi-nfs{{ end }}
EOF

To test the volume in a pod:

cat <<EOF | kubectl apply -f -
apiVersion: v1
kind: Pod
metadata:
  name: test-pod
spec:
  containers:
  - name: test
    image: busybox
    command: ["/bin/sh", "-c", "echo 'Hello from TrueNAS!' > /data/test.txt && cat /data/test.txt && sleep 3600"]
    volumeMounts:
    - name: data
      mountPath: /data
  volumes:
  - name: data
    persistentVolumeClaim:
      claimName: test-pvc
EOF

For more information, visit: https://github.com/fenio/tns-csi
